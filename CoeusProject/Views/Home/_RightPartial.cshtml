@model CoeusProject.Models.Usuario
@using Kendo.Mvc.UI

@{
    Layout = null;
}

<div id="divRightSide" class="divRightSide">
    @Html.TextBox("txtSearch", "", new { @class="k-textbox", @placeholder="Pesquisar grupo"})
    @Html.Kendo().Button().Name("btnSearch").Content("<img src='/Images/searchFind.png' alt='Search'/>")

    <div style="height: 100%">
        <div id="chat" class="divChat"></div>

        <div class="divSubmitChat">
            @Html.TextArea("txtMessage", new { @style = "width: 95%; resize: none; height: 55px" })

            @(Html.Kendo().Button().Name("btnSendMessage")
                .Content("<img src='/Images/sendMessage.png' alt='Send Message'/>")
                .HtmlAttributes(new { @style = "float: right;" }))

            @(Html.Kendo().Button().Name("btnGroupAdd")
                .Content("<img src='/Images/groupAdd.png' alt='Add New Group'/>")
                .HtmlAttributes(new { @style = "float: right;" }))
        </div>
    </div>
</div>

@(Html.Kendo().Window().Name("wndGroup")
    .Modal(true)
    .Title("Grupo")
    .Draggable(true)
    .Content(@<text><div id="wndGroupContent"></div></text>)
    .Events(e=>e.Close("wndGroup_Close($(this))"))
    .Visible(false)
    .Height(300)
    .Width(500)
)

<script type="text/javascript">
    $(document).ready(function () {
        $('#btnGroupAdd').kendoTooltip({
            position: 'top',
            content: 'Criar grupo'
        });

        $('#btnSendMessage').kendoTooltip({
            position: 'top',
            content: 'Enviar mensagem'
        });

        $('#btnSendMessage').click(function (e) {
            e.preventDefault();
            $.ajax({
                url: '@Url.Action("SendMessage","Message")',
                type: 'POST',
                data: {
                    idGroup: 1,
                    txMessage: $('#txtMessage').val()
                },
                success: RefreshChat(),
                error: function (error) {
                    kendoAlert(error.statusText);
                }
            });
        });

        $('#btnGroupAdd').click(function (e) {
            e.preventDefault();
            $('#wndGroupContent').load('@Url.Action("CreatePartial", "Grupo")',
                {}, function () {
                    $('#wndGroup').data('kendoWindow').center().open();
                });
        });
    });

    function wndGroup_Close(e) {
        $('#wndGroupContent').html('');
    }
</script>